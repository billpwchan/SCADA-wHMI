<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<root>   
  <SCOPE name= "SIGHILCTEST_CONF">
    <CONF key = "TEST_NUMBER">4</CONF>
    <CONF key = "FIRST_TEST">1</CONF> 
    <CONF key = "REPEAT">1</CONF>
	<!-- After the tests, all Select Ack should be 0 (dacsimulator % extvar *AckSel*).
	     Some Execute Ack could be greater then 0 : they will be reset by a next Select
		 if necessary, first clean with dacsimulator % run ReacInitLusail -->
	<!-- Command return status are tested (if ERROR is expected, use PREP_EXPECT_STATUS and CONF_EXPECT_STATUS)
	     To test more exactly, offline use the pattern file generated via EXPECT_TRACE_PATTERN with tools :
		 cat on log files, process with resumeLog.awk, and diff (kdiff3) with the pattern file -->
	<!-- This test and the next one : test HILC_MAX_SESSIONS : send several Select commmands -->
    <SCOPE name= "TEST_1">
      <SCOPE name= "CMD_ARG">
        <CONF key = "EQPT">PWRTPSTPS01ICB1_1CB</CONF>
        <CONF key = "EQPT_TYPE">CBR</CONF>
        <CONF key = "CMD_NAME">Close</CONF>
      </SCOPE>
	  <CONF key = "ISSENDCONFACTIVE">0</CONF>
	  <CONF key = "EXPECT_TRACE_PATTERN">---+prepareCmd+equipmentAlias=PWRTPSTPS01ICB1_1CB+equipmentType=CBR+commandName=Close+State_Prep Send Preparation Command OK+State_WaitingConf</CONF>
    </SCOPE>
    <SCOPE name= "TEST_2">
      <SCOPE name= "CMD_ARG">
        <CONF key = "EQPT">PWRTPSTPS01ICB2_1CB</CONF>
        <CONF key = "EQPT_TYPE">CBR</CONF>
        <CONF key = "CMD_NAME">Close</CONF>
      </SCOPE>
	  <CONF key = "ISSENDCONFACTIVE">0</CONF>
	  <CONF key = "EXPECT_TRACE_PATTERN">---+prepareCmd+equipmentAlias=PWRTPSTPS01ICB2_1CB+equipmentType=CBR+commandName=Close+State_Prep Send Preparation Command OK+State_WaitingConf</CONF>
    </SCOPE>
    <SCOPE name= "TEST_3">
      <SCOPE name= "CMD_ARG">
        <CONF key = "EQPT">PWRTPSTPS01TCB_1CB</CONF>
        <CONF key = "EQPT_TYPE">TCBCB</CONF>
        <CONF key = "CMD_NAME">Close</CONF>
      </SCOPE>
	  <CONF key = "ISSENDCONFACTIVE">0</CONF>
	  <CONF key = "EXPECT_TRACE_PATTERN">---+prepareCmd+equipmentAlias=PWRTPSTPS01TCB_1CB+equipmentType=TCBCB+commandName=Close+State_Prep Send Preparation Command OK+State_WaitingConf</CONF>
    </SCOPE>
	<!-- If the HILC_MAX_SESSIONS parameter is set to 3, this Select will be refused (with minor code HILC_MAX_SESSION_ERROR) -->
    <SCOPE name= "TEST_4">
      <SCOPE name= "CMD_ARG">
        <CONF key = "EQPT">PWRTPSTPS01TCB_2CB</CONF>
        <CONF key = "EQPT_TYPE">TCBCB</CONF>
        <CONF key = "CMD_NAME">Close</CONF>
      </SCOPE>
	  <CONF key = "ISSENDCONFACTIVE">0</CONF>
	  <CONF key = "PREP_EXPECT_STATUS">ERROR</CONF>		
	  <CONF key = "PREP_EXPECT_STATUS_MINOR">5</CONF> <!-- HILC_MAX_SESSION_ERROR = 5 -->	  
	  <CONF key = "EXPECT_TRACE_PATTERN">---+prepareCmd+equipmentAlias=PWRTPSTPS01TCB_2CB+equipmentType=TCBCB+commandName=Close+max Session number: KO</CONF>
    </SCOPE>
	<!-- Confirm command linked to TEST_1 : not mandatory -->
    <SCOPE name= "TEST_5">
      <SCOPE name= "CMD_ARG">
        <CONF key = "EQPT">PWRTPSTPS01ICB1_1CB</CONF>
        <CONF key = "EQPT_TYPE">CBR</CONF>
        <CONF key = "CMD_NAME">Close</CONF>
      </SCOPE>
 	  <CONF key = "ISSENDPREPACTIVE">0</CONF>
	  <CONF key = "EXPECT_TRACE_PATTERN">---+confirmCmd+confirmCmd  Error :Preparation Command not found</CONF>
    </SCOPE>
</root>